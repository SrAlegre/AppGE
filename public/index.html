<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="" id="page-css" />
  </head>
  <body>
    <nav class="Navbar">
      <ul>
        <h1>Dashboard</h1>
        <li>
          <a href="http://"><span class="material-icons">home</span>Home</a>
        </li>
        <li>
          <a href="http://"
            ><span class="material-icons">calendar_month</span>Agenda</a
          >
        </li>
        <li>
          <a href="#" data-page="cadastro"
            ><span class="material-icons">app_registration</span>Cadastro</a
          >
        </li>
        <li>
          <a href="http://"
            ><span class="material-icons">person_search</span>Consulta</a
          >
        </li>
      </ul>
    </nav>

    <div id="layout">
      <!-- Conteúdo dinâmico será carregado aqui -->
    </div>

    <script src="script.js"></script>
    <script>document.addEventListener('DOMContentLoaded', () => {
        console.log('Index DOMContentLoaded');
        const links = document.querySelectorAll('nav a');
        const layout = document.getElementById('layout');
        const pageCss = document.getElementById('page-css');

        links.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const page = link.getAttribute('data-page');
                console.log(`Loading page: ${page}`);

                // Carrega o conteúdo HTML dinamicamente
                fetch(`components/${page}/${page}.html`)
                    .then(response => response.text())
                    .then(html => {
                        layout.innerHTML = html;
                        console.log(`${page}.html loaded`);

                        // Atualiza o CSS
                        pageCss.href = `components/${page}/${page}.css`;
                        console.log(`${page}.css loaded`);

                        // Remove o script anterior se existir
                        const oldScript = document.getElementById('page-js');
                        if (oldScript) {
                            oldScript.remove();
                        }

                        // Adiciona o novo script
                        const newScript = document.createElement('script');
                        newScript.src = `components/${page}/script_${page}.js`;
                        newScript.id = 'page-js';
                        newScript.onload = () => {
                            console.log(`script_${page}.js loaded and executed`);
                        };
                        document.body.appendChild(newScript);
                    })
                    .catch(error => console.error('Error loading page:', error));
            });
        });
    });
</script>
  </body>
</html>
